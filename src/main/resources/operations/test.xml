<template xmlns="http://ws.apache.org/ns/synapse" name="test">
    <parameter name="jobId" description="Job ID"/>
    <parameter name="url" description="url"/>
    <parameter name="method" description="url"/>
    <sequence>
        <property name="jobId" expression="$func:jobId" />
        <property name="url" expression="$func:url" />
        <property name="uri.var.url" expression="fn:concat(get-property('instanceUrl'),'')" />
        <class name="org.wso2.carbon.esb.connector.operations.Test" />
        <property name="uri.var.accessToken" expression="get-property('accessTokenTest')" />
        <header name="Authorization"
                expression="fn:concat('Bearer  ', $ctx:uri.var.accessToken )"
                scope="transport"/>
        <call>
            <endpoint>
                <http method="patch" uri-template="{uri.var.url}">
                    <timeout>
                        <duration>60000</duration>
                        <responseAction>fault</responseAction>
                    </timeout>
                    <suspendOnFailure>
                        <initialDuration>2000</initialDuration>
                        <progressionFactor>1.0</progressionFactor>
                        <maximumDuration>3000</maximumDuration>
                    </suspendOnFailure>
                </http>
            </endpoint>
        </call>

    </sequence>
</template>
